<?xml version="1.0"?>
<rdf:RDF
    xmlns="http://northwind.com/model/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:skos="http://www.w3.org/2004/02/skos/core#"
    xmlns:odata4sparql="http://inova8.com/odata4sparql#"
    xmlns:sp="http://spinrdf.org/sp#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:spin="http://spinrdf.org/spin#"
    xmlns:spl="http://spinrdf.org/spl#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
  xml:base="http://northwind.com/operations/">
  <owl:Ontology rdf:about="">
    <owl:versionIRI rdf:resource="http://northwind.com/operations/v3"/>
    <owl:priorVersion rdf:resource="http://northwind.com/operations/v2"/>
    <owl:versionInfo>V3</owl:versionInfo>
    <owl:imports rdf:resource="http://northwind.com/model/"/>
    <owl:imports rdf:resource="http://spinrdf.org/spin"/>
    <owl:imports rdf:resource="http://inova8.com/odata4sparql"/>
    <owl:imports rdf:resource="http://spinrdf.org/spl"/>
  </owl:Ontology>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_Order">
    <rdfs:domain>
      <odata4sparql:Operation rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years">
        <spin:body>
          <sp:Select>
            <sp:text>select ?orderID ?shippedDate (sum(?quantity*?price*(1- ?discount )) as ?subTotal)&#xD;
where{&#xD;
?orderID  a &lt;http://northwind.com/model/Order&gt; .&#xD;
?orderID  &lt;http://northwind.com/model/shippedDate&gt; ?shippedDate.&#xD;
?orderdetail &lt;http://northwind.com/model/order&gt; ?orderID .&#xD;
?orderdetail &lt;http://northwind.com/model/quantity&gt; ?quantity .&#xD;
?orderdetail &lt;http://northwind.com/model/orderDetailUnitPrice&gt; ?price .&#xD;
?orderdetail &lt;http://northwind.com/model/discount&gt; ?discount  . &#xD;
?orderdetail &lt;http://northwind.com/model/product&gt; ?prod .&#xD;
?prod rdfs:label ?prodlabel . FILTER(regex(?prodlabel, ?Summary_of_Sales_by_Years_wildcard)) .  &#xD;
} &#xD;
group by ?orderID  ?shippedDate</sp:text>
            <sp:groupBy rdf:parseType="Collection">
              <rdf:Description>
                <sp:varName>orderID</sp:varName>
              </rdf:Description>
              <rdf:Description>
                <sp:varName>shippedDate</sp:varName>
              </rdf:Description>
            </sp:groupBy>
            <sp:resultVariables rdf:parseType="Collection">
              <rdf:Description>
                <sp:varName>orderID</sp:varName>
                <spl:predicate rdf:resource="http://northwind.com/model/Summary_of_Sales_by_Years_Order"/>
              </rdf:Description>
              <rdf:Description>
                <sp:varName>shippedDate</sp:varName>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_shippedDate"/>
                </spl:predicate>
              </rdf:Description>
              <rdf:Description>
                <sp:expression>
                  <sp:Sum>
                    <sp:expression>
                      <sp:mul>
                        <sp:arg2>
                          <sp:sub>
                            <sp:arg2 rdf:parseType="Resource">
                              <sp:varName>discount</sp:varName>
                            </sp:arg2>
                            <sp:arg1 rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
                            >1</sp:arg1>
                          </sp:sub>
                        </sp:arg2>
                        <sp:arg1>
                          <sp:mul>
                            <sp:arg2 rdf:parseType="Resource">
                              <sp:varName>price</sp:varName>
                            </sp:arg2>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName>quantity</sp:varName>
                            </sp:arg1>
                          </sp:mul>
                        </sp:arg1>
                      </sp:mul>
                    </sp:expression>
                  </sp:Sum>
                </sp:expression>
                <sp:varName>subTotal</sp:varName>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_subTotal"/>
                </spl:predicate>
              </rdf:Description>
            </sp:resultVariables>
            <sp:where rdf:parseType="Collection">
              <rdf:Description>
                <sp:object>
                  <rdf:Description rdf:about="http://northwind.com/model/Order">
                    <rdf:predicate rdf:resource="http://northwind.com/model/order"/>
                  </rdf:Description>
                </sp:object>
                <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderID</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>shippedDate</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/shippedDate"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderID</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>orderID</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/order"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>quantity</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/quantity"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>price</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/orderDetailUnitPrice"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>discount</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/discount"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>prod</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/product"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>prodlabel</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://www.w3.org/2000/01/rdf-schema#label"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>prod</sp:varName>
                </sp:subject>
              </rdf:Description>
              <sp:Filter>
                <sp:expression>
                  <sp:regex>
                    <sp:arg2 rdf:parseType="Resource">
                      <sp:varName>Summary_of_Sales_by_Years_wildcard</sp:varName>
                    </sp:arg2>
                    <sp:arg1 rdf:parseType="Resource">
                      <sp:varName>prodlabel</sp:varName>
                    </sp:arg1>
                  </sp:regex>
                </sp:expression>
              </sp:Filter>
            </sp:where>
          </sp:Select>
        </spin:body>
        <skos:prefLabel>Summary of Sales by Years</skos:prefLabel>
        <spin:constraint>
          <spl:Argument>
            <spl:valueType rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
            <spl:predicate>
              <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_wildcard"/>
            </spl:predicate>
          </spl:Argument>
        </spin:constraint>
        <rdfs:label>Summary of Sales by Years</rdfs:label>
      </odata4sparql:Operation>
    </rdfs:domain>
    <owl:inverseOf>
      <owl:ObjectProperty rdf:about="http://northwind.com/model/Order_Summary_of_Sales_by_Years"/>
    </owl:inverseOf>
    <rdfs:label>Summary of Sales by Years Order</rdfs:label>
    <rdfs:range rdf:resource="http://northwind.com/model/Order"/>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/product_orderSummary">
    <rdfs:label>is referenced in a order summary</rdfs:label>
    <owl:inverseOf>
      <owl:ObjectProperty rdf:about="http://northwind.com/model/orderSummary_product"/>
    </owl:inverseOf>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/order_customer_Order">
    <rdfs:label>is summarized in</rdfs:label>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/customer_Order_customer">
    <rdfs:label>customer_Order_customer</rdfs:label>
    <rdfs:domain>
      <odata4sparql:Operation rdf:about="http://northwind.com/model/Customer_Order">
        <rdfs:label>Customer_Order</rdfs:label>
        <skos:prefLabel>Customer_Order</skos:prefLabel>
        <spin:body>
          <sp:Select>
            <sp:where rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>customer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                <sp:object rdf:resource="http://northwind.com/model/Customer"/>
              </rdf:Description>
              <sp:Optional>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName>customerCompanyName</sp:varName>
                    </sp:object>
                    <sp:subject rdf:parseType="Resource">
                      <sp:varName>customer</sp:varName>
                    </sp:subject>
                  </rdf:Description>
                </sp:elements>
              </sp:Optional>
              <sp:Optional>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName>customerCity</sp:varName>
                    </sp:object>
                    <sp:subject rdf:parseType="Resource">
                      <sp:varName>customer</sp:varName>
                    </sp:subject>
                    <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                  </rdf:Description>
                </sp:elements>
              </sp:Optional>
              <sp:Optional>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <sp:object rdf:parseType="Resource">
                      <sp:varName>customer</sp:varName>
                    </sp:object>
                    <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                    <sp:subject rdf:parseType="Resource">
                      <sp:varName>order</sp:varName>
                    </sp:subject>
                  </rdf:Description>
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>order</sp:varName>
                        </sp:subject>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>shipCity</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                </sp:elements>
              </sp:Optional>
            </sp:where>
            <sp:resultVariables rdf:parseType="Collection">
              <rdf:Description>
                <sp:varName>customer</sp:varName>
                <spl:predicate rdf:resource="http://northwind.com/model/customer_Order_customer"/>
              </rdf:Description>
              <rdf:Description>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCompanyName"/>
                </spl:predicate>
                <sp:varName>customerCompanyName</sp:varName>
              </rdf:Description>
              <rdf:Description>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCity"/>
                </spl:predicate>
                <sp:varName>customerCity</sp:varName>
              </rdf:Description>
              <rdf:Description>
                <sp:varName>order</sp:varName>
                <spl:predicate>
                  <owl:ObjectProperty rdf:about="http://northwind.com/model/customer_Order_order"/>
                </spl:predicate>
              </rdf:Description>
              <rdf:Description>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_shipCity"/>
                </spl:predicate>
                <sp:varName>shipCity</sp:varName>
              </rdf:Description>
            </sp:resultVariables>
            <sp:text>SELECT ?customer  ?customerCompanyName ?customerCity  ?order ?shipCity 
WHERE{
?customer a  &lt;http://northwind.com/model/Customer&gt; .
OPTIONAL{?customer  &lt;http://northwind.com/model/customerCompanyName&gt; ?customerCompanyName }
OPTIONAL{?customer  &lt;http://northwind.com/model/customerCity&gt; ?customerCity } 
OPTIONAL{ ?order &lt;http://northwind.com/model/customer&gt; ?customer . 
	OPTIONAL{ ?order  &lt;http://northwind.com/model/shipCity&gt; ?shipCity  }
	} 
}
</sp:text>
          </sp:Select>
        </spin:body>
        <odata4sparql:deleteBody>
          <sp:Modify>
            <sp:deletePattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDcustomer</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:parseType="Resource">
                  <sp:varName>OLDpredicate</sp:varName>
                </sp:predicate>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDobject</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:parseType="Resource">
                  <sp:varName>OLDorderPredicate</sp:varName>
                </sp:predicate>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDorderObject</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorderDetail</sp:varName>
                </sp:subject>
                <sp:predicate rdf:parseType="Resource">
                  <sp:varName>OLDorderDetailPredicate</sp:varName>
                </sp:predicate>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDorderDetailObject</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:deletePattern>
            <sp:where rdf:parseType="Collection">
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>OLDcustomer</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>OLDcustomerCompanyName</rdf:first>
                    <rdf:rest rdf:parseType="Resource">
                      <rdf:first>OLDcustomerCity</rdf:first>
                      <rdf:rest rdf:parseType="Resource">
                        <rdf:first>OLDorder</rdf:first>
                        <rdf:rest rdf:parseType="Resource">
                          <rdf:first>OLDshipCity</rdf:first>
                          <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        </rdf:rest>
                      </rdf:rest>
                    </rdf:rest>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
              <rdf:Description>
                <rdf:first rdf:parseType="Resource">
                  <sp:subject rdf:parseType="Resource">
                    <sp:varName>OLDcustomer</sp:varName>
                  </sp:subject>
                  <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                  <sp:object rdf:resource="http://northwind.com/model/Customer"/>
                </rdf:first>
                <rdf:rest rdf:parseType="Collection">
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomerCompanyName</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomerCity</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDorder</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:object>
                      </rdf:Description>
                      <sp:Optional>
                        <sp:elements rdf:parseType="Collection">
                          <rdf:Description>
                            <sp:subject rdf:parseType="Resource">
                              <sp:varName>OLDorder</sp:varName>
                            </sp:subject>
                            <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                            <sp:object rdf:parseType="Resource">
                              <sp:varName>OLDshipCity</sp:varName>
                            </sp:object>
                          </rdf:Description>
                        </sp:elements>
                      </sp:Optional>
                    </sp:elements>
                  </sp:Optional>
                </rdf:rest>
              </rdf:Description>
              <sp:Union>
                <sp:elements rdf:parseType="Collection">
                  <rdf:Description>
                    <rdf:first rdf:parseType="Resource">
                      <sp:subject rdf:parseType="Resource">
                        <sp:varName>OLDorder</sp:varName>
                      </sp:subject>
                      <sp:predicate rdf:parseType="Resource">
                        <sp:varName>OLDorderPredicate</sp:varName>
                      </sp:predicate>
                      <sp:object rdf:parseType="Resource">
                        <sp:varName>OLDorderObject</sp:varName>
                      </sp:object>
                    </rdf:first>
                    <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                  </rdf:Description>
                  <rdf:Description>
                    <rdf:first rdf:parseType="Resource">
                      <sp:subject rdf:parseType="Resource">
                        <sp:varName>OLDorderDetail</sp:varName>
                      </sp:subject>
                      <sp:predicate rdf:resource="http://northwind.com/model/order"/>
                      <sp:object rdf:parseType="Resource">
                        <sp:varName>OLDorder</sp:varName>
                      </sp:object>
                    </rdf:first>
                    <rdf:rest rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDorderDetail</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:parseType="Resource">
                          <sp:varName>OLDorderDetailPredicate</sp:varName>
                        </sp:predicate>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDorderDetailObject</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </rdf:rest>
                  </rdf:Description>
                </sp:elements>
              </sp:Union>
            </sp:where>
            <sp:text>DELETE{&#xD;
?OLDorder &lt;http://northwind.com/model/customer&gt; ?OLDcustomer  .&#xD;
?OLDorder ?OLDpredicate ?OLDobject .&#xD;
?OLDorder ?OLDorderPredicate ?OLDorderObject .&#xD;
?OLDorderDetail ?OLDorderDetailPredicate ?OLDorderDetailObject .&#xD;
}WHERE{&#xD;
# Use VALUES to set the ‘incoming’ values posted&#xD;
VALUES(?OLDcustomer  ?OLDcustomerCompanyName ?OLDcustomerCity  ?OLDorder ?OLDshipCity ){&#xD;
##DELETEVALUES(?customer  ?customerCompanyName ?customerCity  ?order ?shipCity )##&#xD;
}&#xD;
# Use the same core query graph pattern as the Operation Query&#xD;
{ 	?OLDcustomer a  &lt;http://northwind.com/model/Customer&gt; .&#xD;
	OPTIONAL{?OLDcustomer  &lt;http://northwind.com/model/customerCompanyName&gt; ?OLDcustomerCompanyName }&#xD;
	OPTIONAL{?OLDcustomer  &lt;http://northwind.com/model/customerCity&gt; ?OLDcustomerCity } &#xD;
	OPTIONAL{ ?OLDorder &lt;http://northwind.com/model/customer&gt; ?OLDcustomer . &#xD;
		OPTIONAL{ ?OLDorder  &lt;http://northwind.com/model/shipCity&gt; ?OLDshipCity  }&#xD;
		} &#xD;
	}&#xD;
# Find all order predicate statements that need to be deleted&#xD;
# and then union all statements related to dependent orderDetails.&#xD;
{&#xD;
	?OLDorder ?OLDorderPredicate ?OLDorderObject&#xD;
}UNION{&#xD;
	?OLDorderDetail &lt;http://northwind.com/model/order&gt; ?OLDorder .&#xD;
    	?OLDorderDetail ?OLDorderDetailPredicate ?OLDorderDetailObject .&#xD;
}&#xD;
}&#xD;
</sp:text>
          </sp:Modify>
        </odata4sparql:deleteBody>
        <odata4sparql:insertBody>
          <sp:Modify>
            <sp:insertPattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                <sp:object rdf:resource="http://northwind.com/model/Customer"/>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomerCompanyName</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomerCity</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWshipCity</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:insertPattern>
            <sp:where rdf:parseType="Collection">
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>NEWcustomer</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>NEWcustomerCompanyName</rdf:first>
                    <rdf:rest rdf:parseType="Resource">
                      <rdf:first>NEWcustomerCity</rdf:first>
                      <rdf:rest rdf:parseType="Resource">
                        <rdf:first>NEWorder</rdf:first>
                        <rdf:rest rdf:parseType="Resource">
                          <rdf:first>NEWshipCity</rdf:first>
                          <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        </rdf:rest>
                      </rdf:rest>
                    </rdf:rest>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
            </sp:where>
            <sp:text>INSERT{&#xD;
# the graph pattern from which the query graph pattern selects its data&#xD;
?NEWcustomer a  &lt;http://northwind.com/model/Customer&gt; .&#xD;
?NEWcustomer  &lt;http://northwind.com/model/customerCompanyName&gt; ?NEWcustomerCompanyName .&#xD;
?NEWcustomer  &lt;http://northwind.com/model/customerCity&gt; ?NEWcustomerCity .&#xD;
?NEWorder &lt;http://northwind.com/model/customer&gt; ?NEWcustomer . &#xD;
?NEWorder  &lt;http://northwind.com/model/shipCity&gt; ?NEWshipCity  .&#xD;
}WHERE{&#xD;
# Use VALUES to set the ‘incoming’ values posted&#xD;
VALUES(?NEWcustomer  ?NEWcustomerCompanyName ?NEWcustomerCity  ?NEWorder ?NEWshipCity ){&#xD;
##INSERTVALUES(?customer  ?customerCompanyName ?customerCity  ?order ?shipCity )##&#xD;
}&#xD;
}&#xD;
</sp:text>
          </sp:Modify>
        </odata4sparql:insertBody>
        <odata4sparql:updateBody>
          <sp:Modify>
            <sp:deletePattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDcustomerCompanyName</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDcustomerCity</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDcustomer</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDshipCity</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:deletePattern>
            <sp:insertPattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomerCompanyName</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomerCity</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWcustomer</sp:varName>
                </sp:object>
              </rdf:Description>
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>NEWorder</sp:varName>
                </sp:subject>
                <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>NEWshipCity</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:insertPattern>
            <sp:where rdf:parseType="Collection">
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>OLDcustomer</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>OLDcustomerCompanyName</rdf:first>
                    <rdf:rest rdf:parseType="Resource">
                      <rdf:first>OLDcustomerCity</rdf:first>
                      <rdf:rest rdf:parseType="Resource">
                        <rdf:first>OLDorder</rdf:first>
                        <rdf:rest rdf:parseType="Resource">
                          <rdf:first>OLDshipCity</rdf:first>
                          <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        </rdf:rest>
                      </rdf:rest>
                    </rdf:rest>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>NEWcustomer</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>NEWcustomerCompanyName</rdf:first>
                    <rdf:rest rdf:parseType="Resource">
                      <rdf:first>NEWcustomerCity</rdf:first>
                      <rdf:rest rdf:parseType="Resource">
                        <rdf:first>NEWorder</rdf:first>
                        <rdf:rest rdf:parseType="Resource">
                          <rdf:first>NEWshipCity</rdf:first>
                          <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        </rdf:rest>
                      </rdf:rest>
                    </rdf:rest>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
              <rdf:Description>
                <rdf:first rdf:parseType="Resource">
                  <sp:subject rdf:parseType="Resource">
                    <sp:varName>OLDcustomer</sp:varName>
                  </sp:subject>
                  <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                  <sp:object rdf:resource="http://northwind.com/model/Customer"/>
                </rdf:first>
                <rdf:rest rdf:parseType="Collection">
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customerCompanyName"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomerCompanyName</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customerCity"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomerCity</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDorder</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:object>
                      </rdf:Description>
                      <sp:Optional>
                        <sp:elements rdf:parseType="Collection">
                          <rdf:Description>
                            <sp:subject rdf:parseType="Resource">
                              <sp:varName>OLDorder</sp:varName>
                            </sp:subject>
                            <sp:predicate rdf:resource="http://northwind.com/model/shipCity"/>
                            <sp:object rdf:parseType="Resource">
                              <sp:varName>OLDshipCity</sp:varName>
                            </sp:object>
                          </rdf:Description>
                        </sp:elements>
                      </sp:Optional>
                    </sp:elements>
                  </sp:Optional>
                </rdf:rest>
              </rdf:Description>
            </sp:where>
            <sp:text>DELETE{&#xD;
# Delete the graph pattern for the values that are going to be updated&#xD;
?OLDcustomer  &lt;http://northwind.com/model/customerCompanyName&gt; ?OLDcustomerCompanyName  .&#xD;
?OLDcustomer  &lt;http://northwind.com/model/customerCity&gt; ?OLDcustomerCity .&#xD;
?OLDorder &lt;http://northwind.com/model/customer&gt; ?OLDcustomer  .&#xD;
?OLDorder  &lt;http://northwind.com/model/shipCity&gt; ?OLDshipCity .&#xD;
}INSERT{&#xD;
# Insert the new values that are provided in the PUT&#xD;
?NEWcustomer  &lt;http://northwind.com/model/customerCompanyName&gt; ?NEWcustomerCompanyName .&#xD;
?NEWcustomer  &lt;http://northwind.com/model/customerCity&gt; ?NEWcustomerCity .&#xD;
?NEWorder &lt;http://northwind.com/model/customer&gt; ?NEWcustomer . &#xD;
?NEWorder  &lt;http://northwind.com/model/shipCity&gt; ?NEWshipCity  .&#xD;
}WHERE{&#xD;
# Declares the values but leave the non-primary key fields (non URI) UNDEF&#xD;
VALUES(?OLDcustomer  ?OLDcustomerCompanyName ?OLDcustomerCity  ?OLDorder ?OLDshipCity ){&#xD;
##DELETEVALUES(?customer  ?customerCompanyName ?customerCity  ?order ?shipCity )##&#xD;
} &#xD;
# Use VALUES to set the ‘incoming’ values posted&#xD;
VALUES(?NEWcustomer  ?NEWcustomerCompanyName ?NEWcustomerCity  ?NEWorder ?NEWshipCity ){&#xD;
##INSERTVALUES(?customer  ?customerCompanyName ?customerCity  ?order ?shipCity )##&#xD;
}&#xD;
# Use the same core query graph pattern as the Operation Query to find the URIs of things to be deleted&#xD;
{ 	?OLDcustomer a  &lt;http://northwind.com/model/Customer&gt; .&#xD;
	OPTIONAL{?OLDcustomer  &lt;http://northwind.com/model/customerCompanyName&gt; ?OLDcustomerCompanyName }&#xD;
	OPTIONAL{?OLDcustomer  &lt;http://northwind.com/model/customerCity&gt; ?OLDcustomerCity } &#xD;
	OPTIONAL{ ?OLDorder &lt;http://northwind.com/model/customer&gt; ?OLDcustomer . &#xD;
		OPTIONAL{ ?OLDorder  &lt;http://northwind.com/model/shipCity&gt; ?OLDshipCity  }&#xD;
		} &#xD;
	}&#xD;
}&#xD;
</sp:text>
          </sp:Modify>
        </odata4sparql:updateBody>
        <odata4sparql:updatePropertyBody>
          <sp:Modify>
            <sp:deletePattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDsubject</sp:varName>
                </sp:subject>
                <sp:predicate rdf:parseType="Resource">
                  <sp:varName>property</sp:varName>
                </sp:predicate>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>OLDvalue</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:deletePattern>
            <sp:insertPattern rdf:parseType="Collection">
              <rdf:Description>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>OLDsubject</sp:varName>
                </sp:subject>
                <sp:predicate rdf:parseType="Resource">
                  <sp:varName>property</sp:varName>
                </sp:predicate>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>value</sp:varName>
                </sp:object>
              </rdf:Description>
            </sp:insertPattern>
            <sp:where rdf:parseType="Collection">
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>OLDcustomer</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>OLDcustomerCompanyName</rdf:first>
                    <rdf:rest rdf:parseType="Resource">
                      <rdf:first>OLDcustomerCity</rdf:first>
                      <rdf:rest rdf:parseType="Resource">
                        <rdf:first>OLDorder</rdf:first>
                        <rdf:rest rdf:parseType="Resource">
                          <rdf:first>OLDshipCity</rdf:first>
                          <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                        </rdf:rest>
                      </rdf:rest>
                    </rdf:rest>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>predicate</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>property</rdf:first>
                    <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                  </rdf:rest>
                </sp:varNames>
                <sp:bindings rdf:parseType="Collection">
                  <rdf:Description>
                    <rdf:first>
                      <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCity"/>
                    </rdf:first>
                    <rdf:rest rdf:parseType="Collection">
                      <rdf:Description rdf:about="http://northwind.com/model/customerCity"/>
                    </rdf:rest>
                  </rdf:Description>
                  <rdf:Description>
                    <rdf:first>
                      <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCompanyName"/>
                    </rdf:first>
                    <rdf:rest rdf:parseType="Collection">
                      <rdf:Description rdf:about="http://northwind.com/model/customerCompanyName"/>
                    </rdf:rest>
                  </rdf:Description>
                  <rdf:Description>
                    <rdf:first>
                      <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_shipCity"/>
                    </rdf:first>
                    <rdf:rest rdf:parseType="Collection">
                      <rdf:Description rdf:about="http://northwind.com/model/shipCity"/>
                    </rdf:rest>
                  </rdf:Description>
                </sp:bindings>
              </sp:Values>
              <sp:Values>
                <sp:varNames rdf:parseType="Resource">
                  <rdf:first>predicate</rdf:first>
                  <rdf:rest rdf:parseType="Resource">
                    <rdf:first>value</rdf:first>
                    <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
                  </rdf:rest>
                </sp:varNames>
              </sp:Values>
              <rdf:Description>
                <rdf:first rdf:parseType="Resource">
                  <sp:subject rdf:parseType="Resource">
                    <sp:varName>OLDcustomer</sp:varName>
                  </sp:subject>
                  <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                  <sp:object rdf:resource="http://northwind.com/model/Customer"/>
                </rdf:first>
                <rdf:rest rdf:parseType="Collection">
                  <sp:Optional>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <sp:subject rdf:parseType="Resource">
                          <sp:varName>OLDorder</sp:varName>
                        </sp:subject>
                        <sp:predicate rdf:resource="http://northwind.com/model/customer"/>
                        <sp:object rdf:parseType="Resource">
                          <sp:varName>OLDcustomer</sp:varName>
                        </sp:object>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Optional>
                </rdf:rest>
              </rdf:Description>
              <rdf:Description>
                <rdf:first>
                  <sp:Union>
                    <sp:elements rdf:parseType="Collection">
                      <rdf:Description>
                        <rdf:first rdf:parseType="Resource">
                          <sp:subject rdf:parseType="Resource">
                            <sp:varName>OLDorder</sp:varName>
                          </sp:subject>
                          <sp:predicate rdf:parseType="Resource">
                            <sp:varName>property</sp:varName>
                          </sp:predicate>
                          <sp:object rdf:parseType="Resource">
                            <sp:varName>OLDvalue</sp:varName>
                          </sp:object>
                        </rdf:first>
                        <rdf:rest rdf:parseType="Collection">
                          <sp:Bind>
                            <sp:variable rdf:parseType="Resource">
                              <sp:varName>OLDsubject</sp:varName>
                            </sp:variable>
                            <sp:expression rdf:parseType="Resource">
                              <sp:varName>OLDorder</sp:varName>
                            </sp:expression>
                          </sp:Bind>
                        </rdf:rest>
                      </rdf:Description>
                      <rdf:Description>
                        <rdf:first rdf:parseType="Resource">
                          <sp:subject rdf:parseType="Resource">
                            <sp:varName>OLDcustomer</sp:varName>
                          </sp:subject>
                          <sp:predicate rdf:parseType="Resource">
                            <sp:varName>property</sp:varName>
                          </sp:predicate>
                          <sp:object rdf:parseType="Resource">
                            <sp:varName>OLDvalue</sp:varName>
                          </sp:object>
                        </rdf:first>
                        <rdf:rest rdf:parseType="Collection">
                          <sp:Bind>
                            <sp:variable rdf:parseType="Resource">
                              <sp:varName>OLDsubject</sp:varName>
                            </sp:variable>
                            <sp:expression rdf:parseType="Resource">
                              <sp:varName>OLDcustomer</sp:varName>
                            </sp:expression>
                          </sp:Bind>
                        </rdf:rest>
                      </rdf:Description>
                    </sp:elements>
                  </sp:Union>
                </rdf:first>
                <rdf:rest rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"/>
              </rdf:Description>
            </sp:where>
            <sp:text>DELETE{&#xD;
# Delete the statement(s) &#xD;
 ?OLDsubject  ?property ?OLDvalue .&#xD;
}INSERT{&#xD;
# Insert  the updated statement&#xD;
?OLDsubject  ?property ?value .&#xD;
}WHERE{&#xD;
# Declares the values but leave the non-primary key fields (non URI) UNDEF&#xD;
VALUES(?OLDcustomer  ?OLDcustomerCompanyName ?OLDcustomerCity  ?OLDorder ?OLDshipCity ){&#xD;
##DELETEVALUES(?customer  ?customerCompanyName ?customerCity  ?order ?shipCity )##&#xD;
}&#xD;
##MAP## operation properties to entity properties&#xD;
VALUES(?predicate ?property){( &lt;http://northwind.com/model/customer_Order_customerCity&gt;   &lt;http://northwind.com/model/customerCity&gt;  ) &#xD;
(&lt;http://northwind.com/model/customer_Order_customerCompanyName&gt; &lt;http://northwind.com/model/customerCompanyName&gt;)&#xD;
(&lt;http://northwind.com/model/customer_Order_shipCity&gt; &lt;http://northwind.com/model/shipCity&gt; ) }&#xD;
# Declares the predicate and value pair to be updated &#xD;
VALUES(?predicate  ?value){&#xD;
##UPDATEPROPERTYVALUES(?predicate  ?value)##&#xD;
} &#xD;
# Use the same core query graph pattern as the Operation Query to find the URIs of things to be deleted&#xD;
{ 	?OLDcustomer a  &lt;http://northwind.com/model/Customer&gt;.&#xD;
	OPTIONAL{ ?OLDorder &lt;http://northwind.com/model/customer&gt; ?OLDcustomer . 	} &#xD;
}&#xD;
# Find all property statements that need to be deleted&#xD;
{{&#xD;
?OLDorder  ?property ?OLDvalue &#xD;
BIND(  ?OLDorder as ?OLDsubject )&#xD;
}UNION{&#xD;
?OLDcustomer  ?property ?OLDvalue&#xD;
BIND(  ?OLDcustomer as ?OLDsubject )&#xD;
}}&#xD;
}&#xD;
</sp:text>
          </sp:Modify>
        </odata4sparql:updatePropertyBody>
      </odata4sparql:Operation>
    </rdfs:domain>
    <rdfs:range rdf:resource="http://northwind.com/model/Customer"/>
    <owl:inverseOf>
      <owl:ObjectProperty rdf:about="http://northwind.com/model/customer_customer_Order"/>
    </owl:inverseOf>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/order_orderSummary">
    <rdfs:label>is referenced in a order summary</rdfs:label>
    <owl:inverseOf>
      <owl:ObjectProperty rdf:about="http://northwind.com/model/orderSummary_order"/>
    </owl:inverseOf>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/customer_customer_Order">
    <rdfs:label>is referenced in customer_order</rdfs:label>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/orderSummary_order">
    <rdfs:label>references order</rdfs:label>
    <rdfs:range rdf:resource="http://northwind.com/model/Order"/>
    <rdfs:domain>
      <odata4sparql:Operation rdf:about="http://northwind.com/model/OrderSummary">
        <spin:body>
          <sp:Select>
            <sp:text>select ?order ?prod (sum(?quantity * ( ?price * (1-?discount) )) as ?value)&#xD;
where{&#xD;
?orderdetail a &lt;http://northwind.com/model/OrderDetail&gt; .&#xD;
?orderdetail &lt;http://northwind.com/model/order&gt; ?order .&#xD;
?orderdetail &lt;http://northwind.com/model/product&gt; ?prod.&#xD;
?orderdetail &lt;http://northwind.com/model/quantity&gt; ?quantity .&#xD;
?orderdetail &lt;http://northwind.com/model/orderDetailUnitPrice&gt; ?price .&#xD;
?orderdetail &lt;http://northwind.com/model/discount&gt; ?discount &#xD;
} group by ?order ?prod</sp:text>
            <sp:groupBy rdf:parseType="Collection">
              <rdf:Description>
                <sp:varName>order</sp:varName>
              </rdf:Description>
              <rdf:Description>
                <sp:varName>prod</sp:varName>
              </rdf:Description>
            </sp:groupBy>
            <sp:resultVariables rdf:parseType="Collection">
              <rdf:Description>
                <sp:varName>order</sp:varName>
                <spl:predicate rdf:resource="http://northwind.com/model/orderSummary_order"/>
              </rdf:Description>
              <rdf:Description>
                <sp:varName>prod</sp:varName>
                <spl:predicate>
                  <owl:ObjectProperty rdf:about="http://northwind.com/model/orderSummary_product"/>
                </spl:predicate>
              </rdf:Description>
              <rdf:Description>
                <sp:expression>
                  <sp:Sum>
                    <sp:expression>
                      <sp:mul>
                        <sp:arg2>
                          <sp:mul>
                            <sp:arg2>
                              <sp:sub>
                                <sp:arg2 rdf:parseType="Resource">
                                  <sp:varName>discount</sp:varName>
                                </sp:arg2>
                                <sp:arg1 rdf:datatype="http://www.w3.org/2001/XMLSchema#integer"
                                >1</sp:arg1>
                              </sp:sub>
                            </sp:arg2>
                            <sp:arg1 rdf:parseType="Resource">
                              <sp:varName>price</sp:varName>
                            </sp:arg1>
                          </sp:mul>
                        </sp:arg2>
                        <sp:arg1 rdf:parseType="Resource">
                          <sp:varName>quantity</sp:varName>
                        </sp:arg1>
                      </sp:mul>
                    </sp:expression>
                  </sp:Sum>
                </sp:expression>
                <sp:varName>value</sp:varName>
                <spl:predicate>
                  <owl:DatatypeProperty rdf:about="http://northwind.com/model/orderSummary_Value"/>
                </spl:predicate>
              </rdf:Description>
            </sp:resultVariables>
            <sp:where rdf:parseType="Collection">
              <rdf:Description>
                <sp:object rdf:resource="http://northwind.com/model/OrderDetail"/>
                <sp:predicate rdf:resource="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>order</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/order"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>prod</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/product"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>quantity</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/quantity"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>price</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/orderDetailUnitPrice"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
              <rdf:Description>
                <sp:object rdf:parseType="Resource">
                  <sp:varName>discount</sp:varName>
                </sp:object>
                <sp:predicate rdf:resource="http://northwind.com/model/discount"/>
                <sp:subject rdf:parseType="Resource">
                  <sp:varName>orderdetail</sp:varName>
                </sp:subject>
              </rdf:Description>
            </sp:where>
          </sp:Select>
        </spin:body>
        <skos:prefLabel>Order summary</skos:prefLabel>
        <rdfs:label>Order summary</rdfs:label>
      </odata4sparql:Operation>
    </rdfs:domain>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/orderSummary_product">
    <rdfs:label>references product</rdfs:label>
    <rdfs:range rdf:resource="http://northwind.com/model/Product"/>
    <rdfs:domain rdf:resource="http://northwind.com/model/OrderSummary"/>
    <owl:cardinality rdf:datatype="http://www.w3.org/2001/XMLSchema#nonNegativeInteger"
    >1</owl:cardinality>
  </owl:ObjectProperty>
  <owl:ObjectProperty rdf:about="http://northwind.com/model/customer_Order_order">
    <rdfs:label>customer_Order_order</rdfs:label>
    <rdfs:range rdf:resource="http://northwind.com/model/Order"/>
    <rdfs:domain rdf:resource="http://northwind.com/model/Customer_Order"/>
    <owl:inverseOf rdf:resource="http://northwind.com/model/order_customer_Order"/>
  </owl:ObjectProperty>
  <rdf:Property rdf:about="http://spinrdf.org/arg#wildcard">
    <rdfs:subPropertyOf rdf:resource="http://spinrdf.org/sp#arg"/>
  </rdf:Property>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCity">
    <rdfs:label>customer_Order_customerCity</rdfs:label>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
    <rdfs:domain rdf:resource="http://northwind.com/model/Customer_Order"/>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_subTotal">
    <rdfs:domain rdf:resource="http://northwind.com/model/Summary_of_Sales_by_Years"/>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <rdfs:label>Summary of Sales by Years sub total</rdfs:label>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_shipCity">
    <rdfs:label>customer_Order_shipCity</rdfs:label>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
    <rdfs:domain rdf:resource="http://northwind.com/model/Customer_Order"/>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_shippedDate">
    <rdfs:domain rdf:resource="http://northwind.com/model/Summary_of_Sales_by_Years"/>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#dateTime"/>
    <rdfs:label>Summary of Sales by Years shipped date</rdfs:label>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/customer_Order_customerCompanyName">
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
    <rdfs:label>customer_Order_customerCompanyName</rdfs:label>
    <rdfs:domain rdf:resource="http://northwind.com/model/Customer_Order"/>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/orderSummary_Value">
    <rdfs:domain rdf:resource="http://northwind.com/model/OrderSummary"/>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#float"/>
    <rdfs:label>order value</rdfs:label>
  </owl:DatatypeProperty>
  <owl:DatatypeProperty rdf:about="http://northwind.com/model/Summary_of_Sales_by_Years_wildcard">
    <rdfs:label>Summary_of_Sales_by_Years_wildcard</rdfs:label>
    <rdfs:range rdf:resource="http://www.w3.org/2001/XMLSchema#string"/>
  </owl:DatatypeProperty>
  <sp:Variable rdf:about="http://rdf.data.intra/envision/operations/long">
    <rdfs:label>long</rdfs:label>
  </sp:Variable>
  <owl:Thing rdf:about="http://northwind.com/model/Operations">
    <rdfs:label>Operations</rdfs:label>
  </owl:Thing>
  <sp:Variable/>
</rdf:RDF>

<!-- Created with TopBraid -->
